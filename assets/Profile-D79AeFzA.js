import{u as w,m as I,a as h,r as c,h as f,j as e,L as x,B as m,I as t,d as j,e as L,n as b}from"./index-Cp4Kj-5H.js";import{E as D}from"./Error-D9sTgV-Y.js";const U=()=>{const i=w(),l=I(),{favorites:o,loading:N,error:d}=h(a=>a.favorites),{user:s}=h(a=>a.auth),[n,_]=c.useState("favorite"),[v,p]=c.useState(!1);c.useEffect(()=>{s?i(f()):l("/")},[i,s,l]);const u=()=>{i(b()).then(()=>{l("/")}).catch(a=>{console.error("Error during logout:",a)})},g=({id:a})=>{p(!0),i(L({id:a.toString()})).then(()=>{i(f())}).finally(()=>{p(!1)})},k=()=>{_("favorite")},F=()=>{_("date")},C=()=>e.jsx("div",{className:"movies",children:v||N?e.jsx("div",{className:"loading-indicator",children:e.jsx(x,{})}):e.jsx("ul",{className:"movies__list",children:d?e.jsx(D,{error:d}):o&&o.length>0?o.map(a=>e.jsxs("li",{className:"movies__item",children:[e.jsx(m,{className:"profile__delete",type:"button",onClick:()=>g({id:a.id.toString()}),children:e.jsx(t,{className:"movies__item-icon",name:"close"})}),e.jsx(j,{to:`/movie/${a.id}`,className:"movies__item-link",children:e.jsx("img",{className:"movies__item-poster",src:a.posterUrl?a.posterUrl:"/empty.png",alt:a.title})})]},a.id)):e.jsx("p",{className:"movies__empty",children:"нет фильмов"})})}),$=a=>{const r=a.trim().split(" ");if(r.length<2)return"";const E=r[0][0],S=r[1][0];return(E+S).toUpperCase()},y=()=>e.jsxs("div",{className:"profile__data",children:[e.jsxs("ul",{className:"profile__data-info",children:[e.jsxs("li",{className:"profile__data-meta",children:[e.jsx("span",{className:"profile__data-icon",children:s!=null&&s.name&&(s!=null&&s.surname)?$(`${s.name} ${s.surname}`):"??"}),e.jsx("p",{className:"profile__data-key",children:"Имя Фамилия"}),e.jsx("h2",{className:"profile__data-value",children:s!=null&&s.name&&(s!=null&&s.surname)?`${s.name} ${s.surname}`:"нет Имя"})]}),e.jsxs("li",{className:"profile__data-meta",children:[e.jsx("span",{className:"profile__data-icon",children:e.jsx(t,{className:"",name:"email"})}),e.jsx("p",{className:"profile__data-key",children:"Электронная почта"}),e.jsx("h2",{className:"profile__data-value",children:(s==null?void 0:s.email)||"нет логин"})]})]}),e.jsx("div",{className:"profile__logout",children:e.jsx(j,{className:"btn",to:"/",onClick:u,children:"Выйти из аккаунта"})})]});return s?e.jsx("div",{className:"profile",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"profile__title",children:"Мой аккаунт"}),e.jsxs("ul",{className:"profile__list",children:[e.jsx("li",{className:"profile__item",children:e.jsxs(m,{className:`profile__item-btn ${n==="favorite"?"active":""}`,onClick:k,children:[e.jsx(t,{className:"profile__item-icon",name:"favorite"}),"Избранные фильмы"]})}),e.jsx("li",{className:"profile__item",children:e.jsxs(m,{className:`profile__item-btn ${n==="date"?"active":""}`,onClick:F,children:[e.jsx(t,{className:"profile__item-icon",name:"auth"}),"Настройка аккаунта"]})})]}),e.jsx("div",{className:"profile__content",children:n==="favorite"?e.jsx(C,{}):e.jsx(y,{})})]})}):e.jsx("div",{children:e.jsx(x,{})})},B=()=>e.jsx(U,{});export{B as default};
